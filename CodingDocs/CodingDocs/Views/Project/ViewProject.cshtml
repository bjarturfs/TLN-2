@model CodingDocs.Models.ViewModels.ViewProjectViewModel

@{
    ViewBag.Title = Model.Name;
}

<h2>@Model.Name</h2>

<div id="file-list">
    @foreach (var file in Model.Files)
    {
        var serializer = new System.Web.Script.Serialization.JavaScriptSerializer();
        var jsonFile = serializer.Serialize(file);

        <button data-json="@jsonFile">@file.Name</button>
        <li>@(file.Name + "." + file.Type + " ")</li>@Html.ActionLink("Delete", "DeleteFile", new { id = file.ID }, new { style = "color:red" })
    }
</div>

@using (Html.BeginForm("SaveFile", "Project", FormMethod.Post))
{
    @Html.Hidden("Content", null, new { @id = "hidden_content" })
    @Html.Hidden("Id", null, new { @id = "hidden_id" })
    <input type="submit" value="Save" />
}

<label class="folderName">@Html.ActionLink("New File", "CreateFile", new { id = Model.ID })</label>

<br />

@Html.ActionLink("Share Project", "InviteUser", new { id = Model.ID })

<div id="editor">
    enginn file valinn
</div>

@if(Model.UserName.Any())
{
    <h3>Users In Project</h3>
}
<ul>
    @foreach (var user in Model.UserName)
    {
        <li>@(user + " ")</li>
    }
</ul>

@section scripts{
    <script src="~/Ace/src/ace.js" type="text/javascript" charset="utf-8"></script>
    <script>
        var editor = ace.edit("editor");
        editor.setTheme("~/Ace/src/theme-monokai.js");
        editor.getSession().setMode("~/Ace/src/mode-javascript.js");

        $("button").click(function () {
            var jsonFile = JSON.parse($(this).attr('data-json'));
            editor.setValue(jsonFile.Content);
            current = jsonFile.ID;
        })

        $("form").submit(function () {
            $("#hidden_content").val(editor.getSession().getValue());
            $("#hidden_id").val(current);
        })
    </script>
}
